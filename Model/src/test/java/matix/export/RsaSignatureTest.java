package matix.export;

import org.junit.jupiter.api.Test;

import static org.junit.jupiter.api.Assertions.*;
import matix.export.RsaSignature;
import  matix.export.RsaEncoder;

import java.math.BigInteger;

class RsaSignatureTest {

    @Test
    void baseValidSignatureTest() {
        BigInteger[] keys = RsaEncoder.generateKeys(512);
        BigInteger e = keys[0];
        BigInteger n = keys[1];
        byte[] msg = {0b00000000,0b01010101,0b00001110,0b00000000,0b01010101,0b00001110,0b00000000,0b01010101,0b00001110,0b00000000,0b01010101,0b00001110,0b00000000,0b01010101,0b00001110,0b00000000,0b01010101,0b00001110,0b00000000,0b01010101,0b00001110,0b00000000,0b01010101,0b00001110,0b00000000,0b01010101,0b00001110,0b00000000,0b01010101,0b00001110,0b00000000,0b01010101,0b00001110,0b00000000,0b01010101,0b00001110,0b00000000,0b01010101,0b00001110,0b00000000,0b01010101,0b00001110,0b00000000,0b01010101,0b00001110,0b00000000,0b01010101,0b00001110,0b00000000,0b01010101,0b00001110,0b00000000,0b01010101,0b00001110,0b00000000,0b01010101,0b00001110,0b00000000,0b01010101,0b00001110,0b00000000,0b01010101,0b00001110,0b00000000,0b01010101,0b00001110};
        byte[] signature = RsaSignature.getSignature(msg,e,n);
        assertTrue(RsaSignature.isSignatureValid(msg,signature,e,n));
    }
    @Test
    void baseInvalidSignatureTest() {
        BigInteger[] keys = RsaEncoder.generateKeys(512);
        BigInteger e = keys[0];
        BigInteger n = keys[1];
        byte[] msg = {0b00000000,0b01010101,0b00001110,0b00000000,0b01010101,0b00001110,0b00000000,0b01010101,0b00001110,0b00000000,0b01010101,0b00001110,0b00000000,0b01010101,0b00001110,0b00000000,0b01010101,0b00001110,0b00000000,0b01010101,0b00001110,0b00000000,0b01010101,0b00001110,0b00000000,0b01010101,0b00001110,0b00000000,0b01010101,0b00001110,0b00000000,0b01010101,0b00001110,0b00000000,0b01010101,0b00001110,0b00000000,0b01010101,0b00001110,0b00000000,0b01010101,0b00001110,0b00000000,0b01010101,0b00001110,0b00000000,0b01010101,0b00001110,0b00000000,0b01010101,0b00001110,0b00000000,0b01010101,0b00001110,0b00000000,0b01010101,0b00001110,0b00000000,0b01010101,0b00001110,0b00000000,0b01010101,0b00001110,0b00000000,0b01010101,0b00001110};
        byte[] signature = RsaSignature.getSignature(msg,e,n);
        msg[0] = 0b01111111;
        assertFalse(RsaSignature.isSignatureValid(msg,signature,e,n));
    }


}